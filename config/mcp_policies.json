{
  "version": "1.0",
  "name": "unblu-mcp-safety-policy",
  "description": "Default safety policy for Unblu MCP server. Allows discovery tools and read-only API operations, blocks destructive operations.",
  "default_effect": "deny",
  "rules": [
    {
      "name": "allow-discovery-tools",
      "effect": "allow",
      "principal_conditions": [],
      "resource_conditions": [
        {
          "path": "attributes.mcp_method",
          "operator": "in",
          "value": ["tools/list", "resources/list", "prompts/list"]
        }
      ],
      "actions": ["access", "read"]
    },
    {
      "name": "allow-read-only-tools",
      "effect": "allow",
      "principal_conditions": [],
      "resource_conditions": [
        {
          "path": "attributes.tool_name",
          "operator": "in",
          "value": ["list_services", "list_operations", "search_operations", "get_operation_schema"]
        }
      ],
      "actions": ["execute"]
    },
    {
      "name": "allow-read-api-calls",
      "effect": "allow",
      "principal_conditions": [],
      "resource_conditions": [
        {
          "path": "attributes.tool_name",
          "operator": "eq",
          "value": "call_api"
        },
        {
          "path": "attributes.args.operation_id",
          "operator": "regex",
          "value": "^[a-zA-Z]*(Get|Search|List|Find|Read|Is|Has|Can|Check|Count|Exists|ProductVersion|Ping)[A-Za-z]*$"
        }
      ],
      "actions": ["execute"]
    },
    {
      "name": "deny-destructive-api-calls",
      "effect": "deny",
      "principal_conditions": [],
      "resource_conditions": [
        {
          "path": "attributes.tool_name",
          "operator": "eq",
          "value": "call_api"
        },
        {
          "path": "attributes.args.operation_id",
          "operator": "regex",
          "value": "(Create|Update|Delete|Set|Add|Remove|Clear|Reset|Send|Post|Put|Patch|Login|Logout|Impersonate|Start|Stop|Forward|Invite|Revoke|Approve|Reject|Pause|Resume|Transform|Migrate|Generate|Invalidate|Offboard|Requeue|Renew|Install|Authenticate|Delivered|SentSuccessfully|Disable|Enable|Finish|End|Export|Change|Write|Trigger|Switch|Restart)"
        }
      ],
      "actions": ["execute"]
    }
  ]
}
